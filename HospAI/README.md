# HospAI - 医院智慧客服系统

## 🏥 项目概述

HospAI 是一个基于 Qt6 开发的现代化医院智慧客服系统，集成了 AI 智能分诊、实时聊天、用户管理、系统统计等完整功能。系统支持患者、客服、管理员三种角色，提供全方位的医疗服务支持。

## ✨ 核心功能

### 🤖 AI 智能分诊系统
- **症状分析**：基于自然语言理解，智能分析患者症状描述
- **科室推荐**：根据症状智能推荐最合适的医院科室  
- **紧急程度评估**：自动评估症状紧急程度，危急情况建议急诊
- **就医指导**：提供专业的就医建议和注意事项
- **转人工服务**：AI无法解决时无缝转接人工客服

### 💬 实时聊天系统
- **患者咨询**：患者可发起咨询会话，实时与客服交流
- **客服管理**：客服可同时处理多个患者咨询，支持会话切换
- **聊天历史**：完整的对话记录存储和查询
- **在线状态**：实时显示用户在线状态
- **消息推送**：基于定时器的实时消息推送机制

### 👨‍💻 管理端系统
- **用户管理**：用户账户的增删改查，角色权限分配
- **系统统计**：用户分布、聊天数据、系统性能等统计分析
- **系统配置**：AI参数、常见问题、科室信息等配置管理
- **审计日志**：操作日志、聊天记录、系统日志的完整记录

### 🗺️ 医院导航系统
- **虚拟平面图**：程序生成的彩色医院布局图
- **交互导航**：点击科室名称查看详细导航路径
- **路径可视化**：红色路径线条、箭头指示、目标标记
- **导航说明**：包含步行时间、特殊提示等详细信息

### 🎨 现代化 UI 设计
- **扁平化设计**：简洁现代的界面风格，蓝灰色系主题
- **统一样式**：全局CSS样式管理，5种按钮样式，7种文本样式  
- **响应式布局**：支持不同屏幕尺寸自适应
- **阴影效果**：为界面元素添加深度感，提升视觉体验

## 🏗️ 技术架构

### 技术栈
- **开发框架**：Qt 6.x / Qt 5.15+ (C++)
- **数据库**：SQLite 3
- **AI 服务**：豆包 API (字节跳动)
- **网络通信**：Qt Network 模块
- **图形界面**：QGraphicsView/QGraphicsScene
- **构建工具**：CMake 3.16+
- **支持平台**：Windows、macOS、Linux

### 系统架构
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│    患者端       │    │    客服端       │    │    管理端       │
│  - AI智能分诊   │    │  - 会话管理     │    │  - 用户管理     │
│  - 人工咨询     │◄───┤  - 实时聊天     │◄───┤  - 系统统计     │
│  - 医院导航     │    │  - 历史记录     │    │  - 配置管理     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────────────────────┼───────────────────────┘
                                 │
                    ┌─────────────────┐
                    │   数据层        │
                    │  - SQLite 数据库 │
                    │  - 用户表       │
                    │  - 聊天会话表   │
                    │  - 消息表       │
                    │  - 系统配置     │
                    └─────────────────┘
```

### 数据库设计

#### 用户表 (users)
- id: 用户ID (主键)
- username: 用户名
- password_hash: 密码哈希
- email: 邮箱
- role: 角色 (患者/客服/管理员)
- real_name: 真实姓名
- created_at: 创建时间
- status: 用户状态

#### 聊天会话表 (chat_sessions)
- id: 会话ID
- patient_id: 患者ID
- staff_id: 客服ID
- status: 会话状态 (等待中/进行中/已结束)
- created_at: 创建时间

#### 聊天消息表 (chat_messages)
- id: 消息ID
- session_id: 会话ID
- sender_id: 发送者ID
- content: 消息内容
- timestamp: 时间戳

## 🚀 快速开始

### 环境要求
- Qt 6.0+ 或 Qt 5.15+
- CMake 3.16+
- C++17 编译器
- SQLite3

### 编译安装

1. **克隆项目**
```bash
git clone <repository-url>
cd HospAI
```

2. **编译项目**
```bash
mkdir build && cd build
cmake ..
make -j4
```

3. **运行程序**
```bash
./HospAI  # Linux/macOS
# 或 HospAI.exe  # Windows
```

### 启动选择

运行程序后会显示启动选择界面：

1. **🏥 医院智慧客服系统（原始功能）**
   - 完整的医院客服系统
   - 支持患者、客服、管理员三种角色
   - 包含所有核心业务功能

2. **🎨 新功能演示**
   - 医院导航系统演示
   - 聊天存储系统演示
   - UI样式管理演示

## 👥 测试账户

系统预置了以下测试账户：

| 用户名 | 密码 | 角色 | 姓名 |
|--------|------|------|------|
| admin | admin123 | 管理员 | 系统管理员 |
| staff1 | 123456 | 客服 | 客服小王 |
| staff2 | 123456 | 客服 | 客服小李 |
| patient1 | 123456 | 患者 | 张三 |
| patient2 | 123456 | 患者 | 李四 |
| patient3 | 123456 | 患者 | 王五 |

## 📖 使用指南

### 患者端使用

1. **登录系统**：使用患者账户登录
2. **AI智能分诊**：
   - 在智能分诊页面描述症状
   - 查看AI推荐的科室和建议
   - 可使用快捷按钮咨询常见问题
3. **转人工咨询**：
   - 点击"转人工客服"按钮
   - 切换到客服咨询页面
   - 发送消息开始与客服交流
4. **医院导航**：
   - 在导航页面点击科室名称
   - 查看详细的导航路径和说明

### 客服端使用

1. **登录系统**：使用客服账户登录
2. **接受咨询**：
   - 在"等待接入"列表查看患者咨询
   - 双击接受患者会话
3. **处理咨询**：
   - 在右侧聊天界面回复患者
   - 可同时处理多个会话
   - 查看患者的AI咨询历史

### 管理端使用

1. **用户管理**：
   - 添加、编辑、删除用户账户
   - 设置用户角色和权限
   - 导出用户数据
2. **系统统计**：
   - 查看用户分布和活跃度
   - 监控系统性能指标
   - 生成统计报表
3. **系统配置**：
   - 配置AI参数和阈值
   - 管理常见问题和科室信息
   - 导入导出配置文件

## 🔧 功能模块详解

### AI 智能分诊

**技术实现**：
- API服务商：豆包 (字节跳动)
- 模型：doubao-lite-32k-character-250228
- 支持症状：50+ 常见症状类型
- 科室覆盖：20+ 临床科室

**功能特性**：
- 自然语言理解和症状分析
- 智能科室推荐和紧急程度评估
- 上下文感知的多轮对话
- 紧急情况自动识别和处理

### 聊天存储系统

**核心组件**：
```cpp
class ChatStorage : public QObject
{
    // SQLite 数据库存储
    // 完整的 CRUD 操作
    // 多种查询方式和分页支持
    // JSON 格式数据导出
};
```

**主要功能**：
- 实时消息存储和查询
- 聊天历史管理和导出
- 用户状态跟踪
- 会话生命周期管理

### 医院导航系统

**核心组件**：
```cpp
class HospitalNavigationWidget : public QWidget
{
    // QGraphicsView 实现的交互式地图
    // 科室位置和路径管理
    // 路径可视化和导航说明
};
```

**内置科室**：
- 门诊科室：内科、外科、儿科、妇科
- 辅助科室：药房、挂号处、检验科
- 专科科室：眼科、耳鼻喉科、皮肤科

### UI 样式管理

**设计特色**：
```cpp
class UIStyleManager
{
    // 统一的颜色方案和样式
    // 5种按钮样式：primary, secondary, success, warning, error
    // 7种文本样式：title, subtitle, normal, caption 等
    // 阴影效果和动画支持
};
```

## 📊 系统特性

### 性能指标
- **AI响应时间**：通常2-5秒
- **消息传递延迟**：2-3秒（基于定时器轮询）
- **并发支持**：多用户同时在线
- **数据库性能**：支持万级数据量

### 安全特性
- 密码哈希存储
- 用户角色权限控制
- HTTPS加密通信
- 操作日志审计

### 扩展性
- 模块化组件设计
- 插件化架构支持
- 多语言国际化准备
- 主题切换机制

## 🔮 后续扩展规划

### 功能增强
- **多媒体消息**：支持图片、语音、视频消息
- **移动端适配**：开发移动APP版本
- **语音交互**：集成语音识别和合成
- **视频通话**：支持远程视频咨询
- **智能预约**：集成医院预约挂号系统

### 技术优化
- **微服务架构**：拆分为独立的服务模块
- **云部署**：支持容器化部署
- **负载均衡**：多实例负载分发
- **缓存系统**：Redis缓存优化
- **监控告警**：完善的系统监控

## 📁 项目结构

```
HospAI/
├── src/                        # 源代码
│   ├── core/                   # 核心功能
│   │   ├── DatabaseManager.*   # 数据库管理
│   │   ├── ChatStorage.*       # 聊天存储
│   │   └── UserRole.h          # 用户角色定义
│   ├── views/                  # 界面组件
│   │   ├── common/             # 通用组件
│   │   ├── patient/            # 患者端
│   │   ├── staff/              # 客服端
│   │   └── admin/              # 管理端
│   └── network/                # 网络通信
├── html/                       # 原型页面
├── resources/                  # 资源文件
├── build/                      # 编译输出
├── CMakeLists.txt             # CMake配置
├── README.md                  # 项目说明
└── .gitignore                 # Git忽略规则
```

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进项目：

1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 发起 Pull Request

## 📄 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 📞 联系支持

如有问题或建议，请通过以下方式联系：

- 提交 GitHub Issue
- 查看代码注释和文档
- 参考项目Wiki

---

**HospAI** - 让医疗服务更智能、更便民！ 