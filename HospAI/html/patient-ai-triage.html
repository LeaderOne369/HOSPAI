<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HospAI - æ‚£è€…æ™ºèƒ½åˆ†è¯Š</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background-color: #F8F9FA;
            padding: 15px;
        }

        .chat-widget {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            height: 80vh;
            min-height: 600px;
        }

        /* é¡¶éƒ¨å·¥å…·æ  - å¯¹åº”Qtçš„m_toolBarLayout */
        .toolbar-layout {
            display: flex;
            padding: 10px 15px;
            gap: 10px;
            border-bottom: 1px solid #E5E5EA;
            align-items: center;
        }

        .toolbar-button {
            background-color: white;
            border: 1px solid #D1D1D6;
            border-radius: 6px;
            padding: 8px 16px;
            font-size: 13px;
            color: #1D1D1F;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toolbar-button:hover {
            background-color: #F2F2F7;
            border-color: #007AFF;
        }

        .toolbar-button.checked {
            background-color: #007AFF;
            color: white;
        }

        .status-label {
            flex: 1;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
            color: #1D1D1F;
            padding: 8px;
        }

        /* å¯Œæ–‡æœ¬å·¥å…·æ  - å¯¹åº”Qtçš„m_richTextToolbar */
        .rich-text-toolbar {
            background-color: #F2F2F7;
            border: 1px solid #D1D1D6;
            border-radius: 8px;
            padding: 5px;
            margin: 10px 15px;
            display: none;
            flex-wrap: wrap;
            gap: 5px;
            align-items: center;
        }

        .rich-text-toolbar.visible {
            display: flex;
        }

        .rich-button {
            background-color: white;
            border: 1px solid #D1D1D6;
            border-radius: 4px;
            padding: 4px 8px;
            font-weight: bold;
            min-width: 24px;
            min-height: 24px;
            cursor: pointer;
        }

        .rich-button:hover {
            background-color: #E5E5EA;
        }

        .rich-button.checked {
            background-color: #007AFF;
            color: white;
        }

        .font-select {
            border: 1px solid #D1D1D6;
            border-radius: 4px;
            padding: 2px 4px;
            background-color: white;
        }

        /* èŠå¤©åŒºåŸŸ - å¯¹åº”Qtçš„m_chatScrollArea */
        .chat-scroll-area {
            flex: 1;
            overflow-y: auto;
            padding: 10px 15px;
        }

        .chat-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-height: 100%;
            justify-content: flex-end;
        }

        .message {
            display: flex;
            margin-bottom: 10px;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message.robot {
            justify-content: flex-start;
        }

        .message-bubble {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .message.user .message-bubble {
            background-color: #007AFF;
            color: white;
        }

        .message.robot .message-bubble {
            background-color: #F2F2F7;
            color: #1D1D1F;
        }

        .message-time {
            font-size: 11px;
            color: #8E8E93;
            margin-top: 4px;
            text-align: center;
        }

        .typing-indicator {
            display: none;
            padding: 12px 16px;
            background-color: #F2F2F7;
            border-radius: 18px;
            max-width: 100px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #8E8E93;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { opacity: 0.3; }
            30% { opacity: 1; }
        }

        /* å¿«æ·æŒ‰é’®åŒºåŸŸ - å¯¹åº”Qtçš„m_quickButtonsArea */
        .quick-buttons-area {
            padding: 10px 15px;
            border-top: 1px solid #E5E5EA;
        }

        .quick-buttons-title {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }

        .quick-buttons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 8px;
        }

        .quick-button {
            background-color: #F2F2F7;
            border: 1px solid #D1D1D6;
            border-radius: 8px;
            padding: 10px 12px;
            font-size: 13px;
            color: #1D1D1F;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .quick-button:hover {
            background-color: #E5E5EA;
            border-color: #007AFF;
        }

        /* è¾“å…¥åŒºåŸŸ - å¯¹åº”Qtçš„m_inputArea */
        .input-area {
            border-top: 1px solid #E5E5EA;
            padding: 15px;
        }

        .input-layout {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .message-input {
            flex: 1;
            border: 2px solid #E5E5EA;
            border-radius: 20px;
            padding: 10px 15px;
            font-size: 14px;
            resize: none;
            min-height: 40px;
            max-height: 120px;
            line-height: 1.4;
        }

        .message-input:focus {
            outline: none;
            border-color: #007AFF;
        }

        .rich-message-input {
            flex: 1;
            border: 2px solid #E5E5EA;
            border-radius: 12px;
            padding: 10px 15px;
            font-size: 14px;
            min-height: 40px;
            max-height: 120px;
            overflow-y: auto;
            display: none;
        }

        .rich-message-input.visible {
            display: block;
        }

        .rich-message-input:focus {
            outline: none;
            border-color: #007AFF;
        }

        .input-buttons {
            display: flex;
            gap: 8px;
        }

        .input-button {
            background-color: #007AFF;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .input-button:hover:not(:disabled) {
            background-color: #0056CC;
        }

        .input-button:disabled {
            background-color: #C7C7CC;
            cursor: not-allowed;
        }

        .input-button.secondary {
            background-color: #6c757d;
        }

        .input-button.secondary:hover {
            background-color: #545b62;
        }
    </style>
</head>
<body>
    <div class="chat-widget">
        <!-- é¡¶éƒ¨å·¥å…·æ  - å¯¹åº”Qtçš„m_toolBarLayout -->
        <div class="toolbar-layout">
            <button class="toolbar-button" onclick="clearChat()">æ¸…ç©ºå¯¹è¯</button>
            <button class="toolbar-button" onclick="saveChat()">ä¿å­˜å¯¹è¯</button>
            <div class="status-label" id="statusLabel">AIæ™ºèƒ½å¯¼è¯Š</div>
            <button class="toolbar-button" id="richModeToggle" onclick="toggleRichMode()">å¯Œæ–‡æœ¬æ¨¡å¼</button>
            <button class="toolbar-button" onclick="openSettings()">è®¾ç½®</button>
        </div>

        <!-- å¯Œæ–‡æœ¬å·¥å…·æ  - å¯¹åº”Qtçš„m_richTextToolbar -->
        <div class="rich-text-toolbar" id="richTextToolbar">
            <span>å­—ä½“:</span>
            <select class="font-select" onchange="changeFont(this.value)">
                <option>Microsoft YaHei</option>
                <option>å®‹ä½“</option>
                <option>é»‘ä½“</option>
            </select>
            <span>å¤§å°:</span>
            <input type="number" class="font-select" value="12" min="8" max="72" style="width: 60px;" onchange="changeFontSize(this.value)">
            <button class="rich-button" onclick="toggleBold()" title="ç²—ä½“"><b>B</b></button>
            <button class="rich-button" onclick="toggleItalic()" title="æ–œä½“"><i>I</i></button>
            <button class="rich-button" onclick="toggleUnderline()" title="ä¸‹åˆ’çº¿"><u>U</u></button>
            <button class="rich-button" onclick="toggleStrike()" title="åˆ é™¤çº¿"><s>S</s></button>
            <button class="rich-button" onclick="changeTextColor()" title="æ–‡å­—é¢œè‰²">ğŸ¨</button>
            <button class="rich-button" onclick="changeBgColor()" title="èƒŒæ™¯é¢œè‰²">ğŸ–ï¸</button>
            <button class="rich-button" onclick="insertImage()" title="æ’å…¥å›¾ç‰‡">ğŸ–¼ï¸</button>
            <button class="rich-button" onclick="insertFile()" title="æ’å…¥æ–‡ä»¶">ğŸ“</button>
        </div>

        <!-- èŠå¤©åŒºåŸŸ - å¯¹åº”Qtçš„m_chatScrollArea -->
        <div class="chat-scroll-area" id="chatScrollArea">
            <div class="chat-container" id="chatContainer">
                <!-- æ¬¢è¿æ¶ˆæ¯ -->
                <div class="message robot">
                    <div>
                        <div class="message-bubble">
                            ğŸ‘‹ æ‚¨å¥½ï¼æˆ‘æ˜¯AIæ™ºèƒ½å¯¼è¯ŠåŠ©æ‰‹ï¼Œå¯ä»¥å¸®åŠ©æ‚¨ï¼š<br><br>
                            ğŸ¥ ç§‘å®¤æ¨èå’ŒåŒ»ç”Ÿä»‹ç»<br>
                            ğŸ“… é¢„çº¦æŒ‚å·æœåŠ¡<br>
                            ğŸ’¡ å¥åº·å’¨è¯¢å’Œç—‡çŠ¶åˆ†æ<br>
                            ğŸ†˜ ç´§æ€¥æƒ…å†µå¤„ç†æŒ‡å¯¼<br><br>
                            è¯·æè¿°æ‚¨çš„ç—‡çŠ¶æˆ–é€‰æ‹©ä¸‹æ–¹å¿«æ·å’¨è¯¢é€‰é¡¹ï¼š
                        </div>
                        <div class="message-time">åˆšåˆš</div>
                    </div>
                </div>

                <!-- æ‰“å­—æŒ‡ç¤ºå™¨ -->
                <div class="message robot">
                    <div class="typing-indicator" id="typingIndicator">
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å¿«æ·æŒ‰é’®åŒºåŸŸ - å¯¹åº”Qtçš„m_quickButtonsArea -->
        <div class="quick-buttons-area">
            <div class="quick-buttons-title">å¿«æ·å’¨è¯¢é€‰é¡¹ï¼š</div>
            <div class="quick-buttons-grid">
                <button class="quick-button" onclick="sendQuickMessage('æˆ‘æƒ³æŒ‚å·ï¼Œè¯·é—®æµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ')">ğŸ¥ æŒ‚å·æµç¨‹å’¨è¯¢</button>
                <button class="quick-button" onclick="sendQuickMessage('æˆ‘å¤´ç–¼ï¼Œåº”è¯¥çœ‹ä»€ä¹ˆç§‘å®¤ï¼Ÿ')">ğŸ©º ç—‡çŠ¶ç§‘å®¤æ¨è</button>
                <button class="quick-button" onclick="sendQuickMessage('åŒ»é™¢çš„è¥ä¸šæ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ')">â° åŒ»é™¢è¥ä¸šæ—¶é—´</button>
                <button class="quick-button" onclick="sendQuickMessage('å¦‚ä½•æŸ¥çœ‹æ£€æŸ¥ç»“æœï¼Ÿ')">ğŸ“‹ æ£€æŸ¥ç»“æœæŸ¥è¯¢</button>
                <button class="quick-button" onclick="sendQuickMessage('åŒ»ä¿æŠ¥é”€éœ€è¦ä»€ä¹ˆææ–™ï¼Ÿ')">ğŸ’³ åŒ»ä¿æŠ¥é”€æŒ‡å¯¼</button>
                <button class="quick-button" onclick="sendQuickMessage('åŒ»é™¢çš„ä½ç½®å’Œäº¤é€šè·¯çº¿')">ğŸš— åŒ»é™¢ä½ç½®å¯¼èˆª</button>
                <button class="quick-button" onclick="sendQuickMessage('æ€¥è¯Šç§‘åœ¨å“ªé‡Œï¼Ÿç°åœ¨å¼€æ”¾å—ï¼Ÿ')">ğŸš¨ æ€¥è¯Šç§‘å’¨è¯¢</button>
                <button class="quick-button" onclick="requestHumanService()">ğŸ‘¨â€âš•ï¸ è½¬äººå·¥å®¢æœ</button>
            </div>
        </div>

        <!-- è¾“å…¥åŒºåŸŸ - å¯¹åº”Qtçš„m_inputArea -->
        <div class="input-area">
            <div class="input-layout">
                <textarea class="message-input" id="messageInput" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..." rows="1" onkeypress="handleKeyPress(event)" oninput="autoResize(this)"></textarea>
                <div class="rich-message-input" id="richMessageInput" contenteditable="true" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..."></div>
                <div class="input-buttons">
                    <button class="input-button secondary" onclick="insertEmoji()">ğŸ˜Š</button>
                    <button class="input-button" id="sendButton" onclick="sendMessage()">å‘é€</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let isRichMode = false;
        let isAITyping = false;

        // AIå›å¤æ¨¡æ¿
        const aiResponses = {
            'æŒ‚å·': 'æŒ‚å·æµç¨‹å¦‚ä¸‹ï¼š\n\n1. ç½‘ä¸Šé¢„çº¦ï¼šå…³æ³¨åŒ»é™¢å¾®ä¿¡å…¬ä¼—å·æˆ–ä¸‹è½½APP\n2. ç°åœºæŒ‚å·ï¼šåˆ°ä¸€æ¥¼æŒ‚å·çª—å£åŠç†\n3. è‡ªåŠ©æŒ‚å·ï¼šä½¿ç”¨è‡ªåŠ©æŒ‚å·æœº\n\næ‚¨å¯ä»¥æå‰1-7å¤©é¢„çº¦ï¼Œå»ºè®®æå‰é¢„çº¦é¿å…æ’é˜Ÿã€‚éœ€è¦æ›´è¯¦ç»†çš„å¸®åŠ©å—ï¼Ÿ',
            'å¤´ç–¼': 'å¤´ç–¼å¯èƒ½æ¶‰åŠå¤šä¸ªç§‘å®¤ï¼Œå»ºè®®ï¼š\n\nğŸ§  ç¥ç»å†…ç§‘ï¼šåå¤´ç—›ã€ç´§å¼ æ€§å¤´ç—›\nğŸ‘ï¸ çœ¼ç§‘ï¼šè§†åŠ›é—®é¢˜å¼•èµ·çš„å¤´ç—›\nğŸ‘ƒ è€³é¼»å–‰ç§‘ï¼šé¼»çª¦ç‚å¼•èµ·çš„å¤´ç—›\nğŸ©¸ å†…ç§‘ï¼šé«˜è¡€å‹ç­‰å†…ç§‘ç–¾ç—…\n\nå¦‚æœæ˜¯çªç„¶å‰§çƒˆå¤´ç—›ï¼Œå»ºè®®ç›´æ¥å»æ€¥è¯Šç§‘ã€‚æ‚¨çš„å¤´ç—›æœ‰ä»€ä¹ˆç‰¹æ®Šç—‡çŠ¶å—ï¼Ÿ',
            'è¥ä¸šæ—¶é—´': 'åŒ»é™¢è¥ä¸šæ—¶é—´ï¼š\n\nğŸ¥ é—¨è¯Šæ—¶é—´ï¼š\nå‘¨ä¸€è‡³å‘¨æ—¥ 8:00-17:00\n\nğŸš¨ æ€¥è¯Šç§‘ï¼š24å°æ—¶å¼€æ”¾\n\nğŸ’Š è¯æˆ¿ï¼š\nå‘¨ä¸€è‡³å‘¨æ—¥ 8:00-21:00\n\nğŸ”¬ æ£€éªŒç§‘ï¼š\nå‘¨ä¸€è‡³å‘¨æ—¥ 7:30-16:30',
            'æ£€æŸ¥ç»“æœ': 'æŸ¥çœ‹æ£€æŸ¥ç»“æœçš„æ–¹å¼ï¼š\n\nğŸ“± æ‰‹æœºAPPï¼šä¸‹è½½åŒ»é™¢å®˜æ–¹APPæŸ¥è¯¢\nğŸ’» å®˜ç½‘æŸ¥è¯¢ï¼šç™»å½•åŒ»é™¢å®˜ç½‘\nğŸ¥ ç°åœºæŸ¥è¯¢ï¼šåˆ°æ£€éªŒç§‘æˆ–ç›¸å…³ç§‘å®¤\nğŸ“ ç”µè¯æŸ¥è¯¢ï¼šæ‹¨æ‰“æŸ¥è¯¢çƒ­çº¿\n\nä¸€èˆ¬æ£€æŸ¥ç»“æœä¼šåœ¨1-3ä¸ªå·¥ä½œæ—¥å†…å‡ºæ¥ï¼Œæ‚¨å¯ä»¥è®¾ç½®ç»“æœé€šçŸ¥æé†’ã€‚',
            'åŒ»ä¿': 'åŒ»ä¿æŠ¥é”€æ‰€éœ€ææ–™ï¼š\n\nğŸ“‹ å¿…å¤‡ææ–™ï¼š\nâ€¢ åŒ»ä¿å¡/ç¤¾ä¿å¡\nâ€¢ èº«ä»½è¯\nâ€¢ ç—…å†æœ¬\nâ€¢ è´¹ç”¨æ¸…å•\nâ€¢ å‘ç¥¨åŸä»¶\n\nğŸ’° æŠ¥é”€æ¯”ä¾‹ï¼š\nâ€¢ é—¨è¯Šï¼š70-90%\nâ€¢ ä½é™¢ï¼š85-95%\n\nå…·ä½“æ¯”ä¾‹è¯·å’¨è¯¢åŒ»ä¿çª—å£å·¥ä½œäººå‘˜ã€‚',
            'ä½ç½®': 'åŒ»é™¢ä½ç½®ä¿¡æ¯ï¼š\n\nğŸ“ åœ°å€ï¼šå¸‚ä¸­å¿ƒäººæ°‘è·¯123å·\n\nğŸš— è‡ªé©¾è·¯çº¿ï¼š\nå¯¼èˆªæœç´¢"å¸‚äººæ°‘åŒ»é™¢"å³å¯\n\nğŸšŒ å…¬å…±äº¤é€šï¼š\nâ€¢ åœ°é“ï¼š2å·çº¿äººæ°‘åŒ»é™¢ç«™Aå‡ºå£\nâ€¢ å…¬äº¤ï¼š15è·¯ã€23è·¯ã€45è·¯åŒ»é™¢ç«™\n\nğŸ…¿ï¸ åœè½¦ï¼šåŒ»é™¢è®¾æœ‰åœ°ä¸‹åœè½¦åœºï¼Œæ”¶è´¹æ ‡å‡†æ¯å°æ—¶5å…ƒ',
            'æ€¥è¯Š': 'æ€¥è¯Šç§‘ä¿¡æ¯ï¼š\n\nğŸ¥ ä½ç½®ï¼šåŒ»é™¢ä¸€æ¥¼ä¸œä¾§\nâ° å¼€æ”¾æ—¶é—´ï¼š24å°æ—¶å…¨å¤©å€™\nğŸš¨ é€‚ç”¨æƒ…å†µï¼š\nâ€¢ ç”Ÿå‘½å±é™©çš„æ€¥ç—‡\nâ€¢ ä¸¥é‡å¤–ä¼¤\nâ€¢ æ€¥æ€§ä¸­æ¯’\nâ€¢ é«˜çƒ­ä¸é€€\n\nğŸ“ æ€¥æ•‘ç”µè¯ï¼š120\nå¦‚æœ‰ç”Ÿå‘½å±é™©è¯·ç«‹å³æ‹¨æ‰“120ï¼'
        };

        function toggleRichMode() {
            isRichMode = !isRichMode;
            const richToolbar = document.getElementById('richTextToolbar');
            const messageInput = document.getElementById('messageInput');
            const richMessageInput = document.getElementById('richMessageInput');
            const toggleButton = document.getElementById('richModeToggle');

            if (isRichMode) {
                richToolbar.classList.add('visible');
                messageInput.style.display = 'none';
                richMessageInput.classList.add('visible');
                toggleButton.classList.add('checked');
            } else {
                richToolbar.classList.remove('visible');
                messageInput.style.display = 'block';
                richMessageInput.classList.remove('visible');
                toggleButton.classList.remove('checked');
            }
        }

        function sendQuickMessage(message) {
            addMessage(message, 'user');
            setTimeout(() => {
                showTypingIndicator();
                setTimeout(() => {
                    hideTypingIndicator();
                    const response = getAIResponse(message);
                    addMessage(response, 'robot');
                }, 2000);
            }, 500);
        }

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const richMessageInput = document.getElementById('richMessageInput');
            let message = '';

            if (isRichMode) {
                message = richMessageInput.innerText.trim();
                richMessageInput.innerHTML = '';
            } else {
                message = messageInput.value.trim();
                messageInput.value = '';
                messageInput.style.height = 'auto';
            }

            if (message) {
                addMessage(message, 'user');
                setTimeout(() => {
                    showTypingIndicator();
                    setTimeout(() => {
                        hideTypingIndicator();
                        const response = getAIResponse(message);
                        addMessage(response, 'robot');
                    }, 2000);
                }, 500);
            }
        }

        function addMessage(content, type) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const now = new Date();
            const timeStr = now.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
            
            messageDiv.innerHTML = `
                <div>
                    <div class="message-bubble">${content.replace(/\n/g, '<br>')}</div>
                    <div class="message-time">${timeStr}</div>
                </div>
            `;
            
            // åœ¨æ‰“å­—æŒ‡ç¤ºå™¨ä¹‹å‰æ’å…¥
            const typingMessage = chatContainer.querySelector('.message.robot:last-child');
            chatContainer.insertBefore(messageDiv, typingMessage);
            
            scrollToBottom();
        }

        function showTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'block';
            scrollToBottom();
        }

        function hideTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        function scrollToBottom() {
            const scrollArea = document.getElementById('chatScrollArea');
            scrollArea.scrollTop = scrollArea.scrollHeight;
        }

        function getAIResponse(message) {
            message = message.toLowerCase();
            
            if (message.includes('æŒ‚å·') || message.includes('é¢„çº¦')) {
                return aiResponses['æŒ‚å·'];
            } else if (message.includes('å¤´ç–¼') || message.includes('å¤´ç—›')) {
                return aiResponses['å¤´ç–¼'];
            } else if (message.includes('æ—¶é—´') || message.includes('è¥ä¸š')) {
                return aiResponses['è¥ä¸šæ—¶é—´'];
            } else if (message.includes('æ£€æŸ¥') || message.includes('ç»“æœ')) {
                return aiResponses['æ£€æŸ¥ç»“æœ'];
            } else if (message.includes('åŒ»ä¿') || message.includes('æŠ¥é”€')) {
                return aiResponses['åŒ»ä¿'];
            } else if (message.includes('ä½ç½®') || message.includes('åœ°å€') || message.includes('è·¯çº¿')) {
                return aiResponses['ä½ç½®'];
            } else if (message.includes('æ€¥è¯Š')) {
                return aiResponses['æ€¥è¯Š'];
            } else {
                return 'æ„Ÿè°¢æ‚¨çš„å’¨è¯¢ï¼æˆ‘æ­£åœ¨åŠªåŠ›ç†è§£æ‚¨çš„é—®é¢˜ã€‚å¦‚æœæ‚¨éœ€è¦æ›´ä¸“ä¸šçš„å¸®åŠ©ï¼Œæˆ‘å¯ä»¥ä¸ºæ‚¨è½¬æ¥äººå·¥å®¢æœã€‚æ‚¨ä¹Ÿå¯ä»¥å°è¯•ä½¿ç”¨ä¸Šæ–¹çš„å¿«æ·å’¨è¯¢é€‰é¡¹ã€‚';
            }
        }

        function requestHumanService() {
            addMessage('æˆ‘éœ€è¦äººå·¥å®¢æœå¸®åŠ©', 'user');
            setTimeout(() => {
                addMessage('æ­£åœ¨ä¸ºæ‚¨è½¬æ¥äººå·¥å®¢æœï¼Œè¯·ç¨å€™...å®¢æœå°ç‹ä¸ºæ‚¨æœåŠ¡ï¼Œè¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ', 'robot');
            }, 1000);
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        function clearChat() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºå¯¹è¯è®°å½•å—ï¼Ÿ')) {
                const chatContainer = document.getElementById('chatContainer');
                // ä¿ç•™æ¬¢è¿æ¶ˆæ¯å’Œæ‰“å­—æŒ‡ç¤ºå™¨
                const welcomeMessage = chatContainer.children[0];
                const typingMessage = chatContainer.children[chatContainer.children.length - 1];
                chatContainer.innerHTML = '';
                chatContainer.appendChild(welcomeMessage);
                chatContainer.appendChild(typingMessage);
            }
        }

        function saveChat() {
            alert('å¯¹è¯è®°å½•å·²ä¿å­˜åˆ°æœ¬åœ°');
        }

        function openSettings() {
            alert('è®¾ç½®åŠŸèƒ½å¼€å‘ä¸­...');
        }

        function insertEmoji() {
            alert('è¡¨æƒ…åŠŸèƒ½å¼€å‘ä¸­...');
        }

        // å¯Œæ–‡æœ¬ç¼–è¾‘åŠŸèƒ½
        function toggleBold() { document.execCommand('bold'); }
        function toggleItalic() { document.execCommand('italic'); }
        function toggleUnderline() { document.execCommand('underline'); }
        function toggleStrike() { document.execCommand('strikeThrough'); }
        function changeTextColor() { 
            const color = prompt('è¯·è¾“å…¥é¢œè‰²ï¼ˆå¦‚ï¼šred, #ff0000ï¼‰ï¼š');
            if (color) document.execCommand('foreColor', false, color);
        }
        function changeBgColor() { 
            const color = prompt('è¯·è¾“å…¥èƒŒæ™¯é¢œè‰²ï¼ˆå¦‚ï¼šyellow, #ffff00ï¼‰ï¼š');
            if (color) document.execCommand('backColor', false, color);
        }
        function changeFont(font) { document.execCommand('fontName', false, font); }
        function changeFontSize(size) { document.execCommand('fontSize', false, size); }
        function insertImage() { alert('æ’å…¥å›¾ç‰‡åŠŸèƒ½å¼€å‘ä¸­...'); }
        function insertFile() { alert('æ’å…¥æ–‡ä»¶åŠŸèƒ½å¼€å‘ä¸­...'); }
    </script>
</body>
</html> 